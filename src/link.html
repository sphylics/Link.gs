<!--  JSを無効にしてる人のために  -->
<noscript>
  <div style="background-color:#ffdddd;color:#990000;padding:1em;border:1px solid #cc0000;font-weight:bold;text-align:center;">
    このサイトを利用するにはJavaScriptを有効にしてください。
  </div>
</noscript>

<script data-code="Link.js">
const BASE_URL = "<?!= getAppUrl() ?>";

function load(content) {
  window.top.location.href = BASE_URL + content;
}

document.addEventListener("DOMContentLoaded", () => {
  document.addEventListener("click", async (e) => {
    // a要素 or [href] を持つ要素を探す
    const elem = e.target.closest("[href]");
    if (!elem) return; // [href] じゃなければ無視

    const fullLink = elem.getAttribute("href");
    if (!fullLink || fullLink === "" || fullLink.startsWith("javascript:")) return;

    e.preventDefault();

    // #で分割
    const [queryPart, hashPart] = fullLink.split("#");

    // hashのみでqueryなしの場合はスクロールだけ
    if ((!queryPart || queryPart === "") && hashPart) {
      const targetElem = document.getElementById(hashPart);
      if (targetElem) targetElem.scrollIntoView({ behavior: "smooth" });
      return;
    }

    // queryがある場合はページ遷移
    if (queryPart && queryPart !== "") {
      await load(queryPart);

      // hashがある場合のスクロールは load() 側で処理する想定
    }
  });
});
</script>